<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>
			{% block title %}
				Nargui Five 93 - Made in France
			{% endblock %}
		</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content=" Nargui Five La boutique qui vous vends des chichas / CBD .">
		<meta name="author" content="Banyingela Blanchard">
		<meta property="og:title" content="Nargui Five"/>
		<meta property="og:type" content="Site E-commerce"/>
		<meta property="og:url" content="https://narguifive.com"/>
		<meta property="og:image" content=""/>

		<link rel="icon" href="{{ asset('assets/images/icones/logo_2.png') }}"/>
		<!-- Bootstrap CSS -->
		<link
		href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<!-- Bootstrap icone -->
		<link
		rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
		<!-- fontawesome icone -->
		<script src="https://kit.fontawesome.com/3b962b3bc8.js" crossorigin="anonymous"></script>

		<!-- Bootstrap JS + jquery -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

		<!-- Custom styles for this template -->
		<link href="{{ asset('assets/css/carousel.css') }}" rel="stylesheet">

		{% block stylesheets %}
			{{ encore_entry_link_tags('app') }}
		{% endblock %}

		{% block javascript_header %}
			{{ encore_entry_script_tags('app') }}
		{% endblock %}

		<!-- Nargui CSS -->
		<link href="{{ asset('assets/css/style-custome.css') }}" rel="stylesheet">
		<link href="{{ asset('assets/css/style.css') }}" rel="stylesheet">
	</head>

	<body>

		{# {% include "partials/_nav.html.twig" %} #}

		{{ render( controller('App\\Controller\\MenuController::index' ) ) }}
		
		<main role="main">
			{% if block('carousel') is defined %}
				{% include "partials/_carousel.html.twig" %}
			{% endif %}

			<div class="marketing  {% if block('carousel') is not defined %} {% endif%}"> 
				{% block body %}{% endblock %}
			</div>
				
			<!-- FOOTER -->
			{% include "partials/_footer.html.twig" %}
		</main>

		<script src="{{ asset('assets/js/bootstrap.bundle.js') }}"></script>
		<script src="{{ asset('assets/js/javascript.js') }}"></script>
		<script src="{{ asset('assets/js/myjs.js') }}"></script>
		<script src="{{ asset('assets/js/filter.js') }}"></script>
		<script src="{{ asset('assets/js/tri.js') }}"></script>

		{% block script %}
			<script>
				var storage = JSON.parse(localStorage.getItem("produit"));
				if (! storage) {
				storage = [];
				document.getElementById('panier_number').innerHTML = 0;
				} else {
				document.getElementById('panier_number').innerHTML = storage.length;

				}
			</script>
			<script>
				function panier_gestion(a) {
					ant = {id: a};
					ancien = JSON.parse(localStorage.getItem("produit"));
					if (ancien) {

						ancien.push(ant);
						localStorage.setItem("produit", JSON.stringify(ancien));
						console.log(ancien);
						document.getElementById('panier_number').innerHTML = ancien.length;
					} else {
						ancien = [];
						ancien.push(ant);
						localStorage.setItem("produit", JSON.stringify(ancien));
						console.log(ancien);
						document.getElementById('panier_number').innerHTML = ancien.length;

					}

				}
			</script>
		

			<!--script>
				localStorage.clear();
			</script-->

			<script>
			function mara(object){
			
				//alert(object.getAttribute('id'));
				var tab= object.getAttribute('id').split("_");
				if(tab[1] == "actif"){
					var m= "#layered_manufacturer_"+tab[2];
				}else{
					var m= "#layered_quantity_"+tab[2];
				}
				
				$(m).prop( "checked", false );
				var Myquant=new Array();

				const myfilterform = document.querySelector("#layered_form");
				const formulaire= new FormData(myfilterform);
				const parametre = new URLSearchParams();
				formulaire.forEach((key,value) =>{
					if(value.includes('layered_quantity')){
						Myquant.push(key); 

					}
					parametre.append(value,key);
				});

				const sorting=$('#productsSortForm option:selected').val()
				
				parametre.append('tri',sorting);

				const lien= new URL(window.location.href);
				fetch(lien.pathname+"?"+ parametre.toString()+"&ajax=1",{
					headers:{
						"X-Requested-With":"XMLHttpRequest"
					}

				}).then(response=>
					response.json()
				).then(data => {
					const contents = document.querySelector("#products_filter");
					const totals= document.querySelector("#total");
					const myfiltre_actif=document.querySelector("#filtre_actif");
					const Q0 = document.querySelector("#quantity_0");
					const Q1= document.querySelector("#quantity_1");

					nombre=Object.keys(data.fabs).length;
					var text="";
					for (var i=0;i<nombre;i++){
						var id= data.fabs[i].id;
						var nom=data.fabs[i].nom;
						text = text + "<li>" +
						"<a  role =\"button\" data-rel=\"layered_manufacturer_"+ id + "\" title=\"Annuler\"><i class=\"icon-remove\" id=\"filtre_actif_"+ id + "\" onclick=\"mara(this)\"></i></a>"+	
							"Fabricant : "+nom+	
					"</li>";
					}

					if(Myquant != null){
						if(Myquant.includes("0")){
							text = text + "<li>" +
							"<a  role =\"button\" data-rel=\"layered_quantity_0 \" title=\"Annuler\"><i class=\"icon-remove\" id=\"disp_actif_0\" onclick=\"mara(this)\"></i></a>"+	
								"Disponibilité : En cours de réapprovisionnements</li>";
						}
						if(Myquant.includes("1")){
							text = text + "<li>" +
							"<a  role =\"button\" data-rel=\"layered_quantity_1 \" title=\"Annuler\"><i class=\"icon-remove\" id=\"disp_actif_1\" onclick=\"mara(this)\"></i></a>"+	
								"Disponibilité : En stock</li>";
						}

					}
					Q0.innerHTML=" ("+data.nbre_dispo[0]+")";
					Q1.innerHTML=" ("+data.nbre_dispo[1]+")";
					myfiltre_actif.innerHTML=text;
					totals.innerHTML="Il y a "+ data.total+" produits";
					contents.innerHTML= data.content;
					history.pushState({},null,lien.pathname+"?"+ parametre.toString());

				}).catch(e=>console.log(e));
			}
			</script>
			

			
			
			
			
		{% endblock %}

		</html>
	</body>
</html>
